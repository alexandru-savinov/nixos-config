#!/bin/sh
# Git credential helper: reads GitHub PAT from the agenix-managed secret.
# Replaces plaintext ~/.git-credentials so the token is never stored in clear text.
# Secret file format: a single line containing the raw PAT token.
if [ "$1" = "get" ]; then
  TOKEN=$(cat /run/agenix/kuzea-github-token 2>/dev/null | tr -d '[:space:]')
  if [ -z "$TOKEN" ]; then
    exit 1
  fi
  printf 'username=alexandru-savinov\n'
  printf 'password=%s\n' "$TOKEN"
fi
